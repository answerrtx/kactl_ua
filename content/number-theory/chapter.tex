\chapter{Number theory}

\section{Modular arithmetic}
	\kactlimport{ModularArithmetic.h}
	\kactlimport{ModInverse.h}
	\kactlimport{ModPow.h}
	\kactlimport{ModPowMatrix.h}
	\kactlimport{ModLog.h}
	\kactlimport{ModSum.h}
	\kactlimport{ModMulLL.h}
	\kactlimport{ModSqrt.h}

\section{Primality}
	\kactlimport{FastEratosthenes.h}
	\kactlimport{MillerRabin.h}
	\kactlimport{Factor.h}

\section{Divisibility}
	\kactlimport{euclid.h}
	% \kactlimport{Euclid.java}
	\kactlimport{CRT.h}

	\subsection{BÃ©zout's identity}
	For $a \neq $, $b \neq 0$, then $d=gcd(a,b)$ is the smallest positive integer for which there are integer solutions to
	$$ax+by=d$$
	If $(x,y)$ is one solution, then all solutions are given by
	$$\left(x+\frac{kb}{\gcd(a,b)}, y-\frac{ka}{\gcd(a,b)}\right), \quad k\in\mathbb{Z}$$

	\kactlimport{phiFunction.h}

\section{Fractions}
	\kactlimport{ContinuedFractions.h}
	\kactlimport{FracBinarySearch.h}

\section{Pythagorean Triples}
 The Pythagorean triples are uniquely generated by
 \[ a=k\cdot (m^{2}-n^{2}),\ \,b=k\cdot (2mn),\ \,c=k\cdot (m^{2}+n^{2}), \]
 with $m > n > 0$, $k > 0$, $m \bot n$, and either $m$ or $n$ even.

\section{Primes}
	$p=962592769$ is such that $2^{21} \mid p-1$, which may be useful. For hashing
	use 970592641 (31-bit number), 31443539979727 (45-bit), 3006703054056749
	(52-bit). There are 78498 primes less than 1\,000\,000.

	Primitive roots exist modulo any prime power $p^a$, except for $p = 2, a > 2$, and there are $\phi(\phi(p^a))$ many.
	For $p = 2, a > 2$, the group $\mathbb Z_{2^a}^\times$ is instead isomorphic to $\mathbb Z_2 \times \mathbb Z_{2^{a-2}}$.

\section{Estimates}
	$\sum_{d|n} d = O(n \log \log n)$.

	The number of divisors of $n$ is at most around 100 for $n < 5e4$, 500 for $n < 1e7$, 2000 for $n < 1e10$, 200\,000 for $n < 1e19$.

\section{Mobius Function}
\[
	\mu(n) = \begin{cases} 0 & n \textrm{ is not square free}\\ 1 & n \textrm{ has even number of prime factors}\\ -1 & n \textrm{ has odd number of prime factors}\\\end{cases}
\]
  Mobius Inversion:
  \[ g(n) = \sum_{d|n} f(d) \Leftrightarrow f(n) = \sum_{d|n} \mu(d)g(n/d) \]
  Other useful formulas/forms:

  $ \sum_{d | n} \mu(d) = [ n = 1] $ (very useful)

  $ g(n) = \sum_{n|d} f(d) \Leftrightarrow f(n) = \sum_{n|d} \mu(d/n)g(d)$

 $ g(n) = \sum_{1 \leq m \leq n} f(\left\lfloor\frac{n}{m}\right \rfloor ) \Leftrightarrow f(n) = \sum_{1\leq m\leq n} \mu(m)g(\left\lfloor\frac{n}{m}\right\rfloor)$

 \text{Type I}
 \begin{small}
 \begin{equation}
	\begin{gathered}
	\sum_{i=1}^n \sum_{j=1}^m[\operatorname{gcd}(i, j)=1]=\sum_{i=1}^n \sum_{j=1}^m \sum_{x \mid i} \sum_{x \mid j} \mu(x) \\
	=\sum_{x=1}^n \mu(x) \sum_{i=1}^n \sum_{j=1}^m[x \mid i][x \mid j] 
	=\sum_{x=1}^n \mu(x)\left\lfloor\frac{n}{x}\right\rfloor\left\lfloor\frac{m}{x}\right\rfloor
	\end{gathered}
	\end{equation}
\end{small}
$O(n)$ initialization, $O(sqrt(n))$ query.

\textbf{Type II}
\begin{small}
\begin{equation}
	\begin{gathered}
	\sum_{i=1}^n \sum_{j=1}^m \operatorname{gcd}(i, j)=\sum_{i=1}^n \sum_{j=1}^m \sum_{x \mid i} \sum_{x \mid j} \phi(x) \\
	=\sum_{x=1}^n \phi(x) \sum_{i=1}^n \sum_{j=1}^m[x \mid i][x \mid j] 
	=\sum_{x=1}^n \phi(x)\left\lfloor\frac{n}{x}\right\rfloor\left\lfloor\frac{m}{x}\right\rfloor
	\end{gathered}
	\end{equation}
\end{small}

\textbf{Type III}
\begin{small}
\begin{equation}
	\begin{gathered}
	\sum_{i=1}^n \sum_{j=1}^m f(\operatorname{gcd}(i, j))=\sum_{d=1}^n f(d) \sum_{i=1}^n \sum_{j=1}^m[\operatorname{gcd}(i, j)=d] \\
	=\sum_{d=1}^n f(d) \sum_{i=1}^{\left\lfloor\frac{n}{d}\right\rfloor} \sum_{j=1}^{\left\lfloor\frac{m}{d}\right\rfloor}[\operatorname{gcd}(i, j)=1] 
	\left.=\sum_{d=1}^n f(d) \sum_{k=1}^{\left\lfloor\frac{n}{d}\right\rfloor} \mu(k)\left\lfloor\frac{n}{d k}\right\rfloor \frac{m}{d k}\right\rfloor
	\end{gathered}
	\end{equation}
	let $T=dk$, then
	\begin{equation}
		=\sum_{T=1}^n\left\lfloor\frac{n}{T}\right\rfloor\left\lfloor\frac{m}{T}\right\rfloor \sum_{d \mid T} f(d) \mu\left(\frac{T}{d}\right)
		\end{equation}
	\end{small}

 \section{Min25 Sieve}
 \kactlimport{Min25.h}